 1.2 Задание step 6
/*В конце года цену всех книг на складе пересчитывают – снижают ее на 30%. Написать SQL запрос, который из таблицы book 
выбирает названия, авторов, количества и вычисляет новые цены книг. Столбец с новой ценой назвать new_price, 
цену округлить до 2-х знаков после запятой.

ROUND(x, k)	округляет значение x до k знаков после запятой,
если k не указано – x округляется до целого	ROUND(4.361)=4
ROUND(5.86592,1)=5.9 */

РЕШЕНИЕ:

SELECT 
  title, 
  author, 
  amount, 
  ROUND (
    (price * 0.7), 
    2
  ) AS new_price 
FROM 
  book;


 1.2 Задание step 7
/*При анализе продаж книг выяснилось, что наибольшей популярностью пользуются книги Михаила Булгакова, на втором месте 
книги Сергея Есенина. Исходя из этого решили поднять цену книг Булгакова на 10%, а цену книг Есенина - на 5%. 
Написать запрос, куда включить автора, название книги и новую цену, последний столбец назвать new_price. 
Значение округлить до двух знаков после запятой. 

В SQL реализована возможность заносить в поле значение в зависимости от условия. Для этого используется функция IF:

IF(логическое_выражение, выражение_1, выражение_2)
Функция вычисляет логическое_выражение, если оно истина – в поле заносится значение выражения_1, в противном случае –  
значение выражения_2. Все три параметра IF() являются обязательными.

Допускается использование вложенных функций, вместо выражения_1 или выражения_2 может стоять новая функция IF.*/

РЕШЕНИЕ:

SELECT 
  author, 
  title, 
  ROUND (
    IF (
      author = "Булгаков М.А.", 
      price * 1.1, 
    IF (
      author = "Есенин С.А.", 
      price * 1.05, 
      price)), 
      2
    ) AS new_price
  from book;


 1.2 Задание step 8
/*Вывести автора, название  и цены тех книг, количество которых меньше 10.*/

Пример

/*Вывести название, автора  и стоимость (цена умножить на количество) тех книг, стоимость которых больше 4000 рублей
SELECT title, author, price * amount AS total
FROM book
WHERE price * amount > 4000;*/


РЕШЕНИЕ:

SELECT author, 
	title,
	price
	FROM book
	WHERE amount < 10;


1.2 Задание step 9
/*Вывести название, автора,  цену  и количество всех книг, цена которых меньше 500 или больше 600, а стоимость всех экземпляров этих книг больше или равна 5000.
*/

Пример

/*Вывести название, цену  тех книг, которые написал Булгаков или Есенин, ценой больше 600 рублей

Запрос:

SELECT title, author, price 
FROM book
WHERE (author = 'Булгаков М.А.' OR author = 'Есенин С.А.') AND price > 600;*/


РЕШЕНИЕ:

SELECT title,
	author,
	price,
	amount
	FROM book
	WHERE (price < 500 OR price > 600) AND ((price * amount) >= 5000);


1.2 Задание step 10
/*Вывести название и авторов тех книг, цены которых принадлежат интервалу от 540.50 до 800 (включая границы),  а количество или 2, или 3, или 5, или 7 .
*/


Пример

/*Выбрать названия и цены книг, написанных Булгаковым или Достоевским.

Запрос:

SELECT title, price 
FROM book
WHERE author IN ('Булгаков М.А.', 'Достоевский Ф.М.');

Выбрать названия и количества тех книг, количество которых от 5 до 14 включительно.

Запрос:

SELECT title, amount 
FROM book
WHERE amount BETWEEN 5 AND 14;*/


РЕШЕНИЕ:

SELECT title,
	author
	FROM book
	WHERE price BETWEEN 540.50 AND 800 AND amount IN (2, 3, 5, 7);

	1.2 Задание step 11
/*Вывести  автора и название  книг, количество которых принадлежит интервалу от 2 до 14 (включая границы). Информацию  отсортировать сначала по авторам 
(в обратном алфавитном порядке), а затем по названиям книг (по алфавиту).
*/
При выборке можно указывать столбец или несколько столбцов, по которым необходимо отсортировать отобранные строки. 
Для этого используются ключевые слова ORDER BY, после которых задаются имена столбцов. При этом строки сортируются по первому столбцу, если указан второй
 столбец, сортировка осуществляется только для тех строк, у которых значения первого столбца одинаковы. По умолчанию ORDER BY выполняет сортировку 
 по возрастанию. Чтобы управлять направлением сортировки вручную, после имени столбца указывается ключевое слово ASC (по возрастанию) или DESC (по убыванию).

Пример

/*Пример

Вывести автора, название и количество книг, в отсортированном в алфавитном порядке по автору и по убыванию количества, для тех книг, цены которых меньше 750 рублей.

Запрос:

SELECT author, title, amount AS Количество
FROM book
WHERE price < 750
ORDER BY author, amount DESC;
*/


РЕШЕНИЕ:

SELECT author,
	title
	FROM book
	WHERE amount BETWEEN 2 AND 14
	ORDER BY author DESC, title;


1.2 Задание step 12
/*Вывести название и автора тех книг, название которых состоит из двух и более слов, а инициалы автора содержат букву «С». 
Считать, что в названии слова отделяются друг от друга пробелами и не содержат знаков препинания, между фамилией автора и инициалами
 обязателен пробел, инициалы записываются без пробела в формате: буква, точка, буква, точка. Информацию отсортировать по названию книги в алфавитном порядке.
 */

Theory:
Оператор LIKE используется для сравнения строк. В отличие от операторов отношения равно (=) и не равно (<>), LIKE позволяет сравнивать строки
 не на полное совпадение (не совпадение), а в соответствии с шаблоном. Шаблон может включать обычные символы и символы-шаблоны. 
 При сравнении с шаблоном, его обычные символы должны в точности совпадать с символами, указанными в строке. Символы-шаблоны могут совпадать с 
 произвольными элементами символьной строки.

 /* EXAMPLE:
 SELECT * FROM book WHERE author LIKE '%М.%'
выполняет поиск и выдает все книги, инициалы авторов которых содержат «М.»

Вывести названия книг, которые содержат букву "и" как отдельное слово, если считать, что слова в названии отделяются друг от друга пробелами и не содержат знаков препинания.

 Запрос:

SELECT title FROM book 
WHERE   title LIKE "_% и _%" /*отбирает слово И внутри названия */
    OR title LIKE "и _%" /*отбирает слово И в начале названия */
    OR title LIKE "_% и" /*отбирает слово И в конце названия */
    OR title LIKE "и" /* отбирает название, состоящее из одного слова И */ 

SOLUTION:

SELECT title,
	author
    FROM book
	WHERE title LIKE "_% _%" AND author LIKE "%С.%"
    ORDER BY title;

1.2 Задание step 13
/*Магазин счёл, что классика уже не пользуется популярностью, поэтому необходимо в выборке:

1. Сменить всех авторов на "Донцова Дарья".

2. К названию каждой книги в начале дописать "Евлампия Романова и".

3. Цену поднять на 42%.

4. Отсортировать по убыванию цены и убыванию названия.
 */


SOLUTION:

SELECT 
    "Донцова Дарья" AS author, 
    CONCAT("Евлампия Романова и ", title) AS title, 
    round((price * 1.42),2) AS price
FROM book
ORDER BY 3 DESC, 2 DESC



